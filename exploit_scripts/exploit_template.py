import pwn

class_name = 'SampleExploit'

class SampleExploit: 

    # Service that is exploited, either name, id or port
    target_service = 'service_name'

    def __init__(self, game_client):
        self.service = game_client.service(target_service)

    def __str__(self):
        return "Sample exploit template"

    def run(self, target):
        # Argument: Target IP or hostname
        port = self.service.port
        timeout_dur = 2

        r = pwn.remote(target, port)

        #include timeouts to prevent hangs
        r.recvuntil("username:", timeout=timeout_dur)
        r.send("admin\n")
        r.recvuntil("password:", timeout=timeout_dur)
        r.send("admin\n")
        output = r.recvall(timeout=timeout_dur)

        #parse output into flags
        flags = []

        return flags